<div
    class="min-h-screen bg-gradient-to-br from-purple-700 via-fuchsia-600 to-pink-500 flex flex-col items-center py-10">
    <h1 class="text-4xl font-extrabold text-white mb-4 drop-shadow-lg">ADMINISTRADOR DE TAREAS</h1>

    <!-- Search bar -->
    <div class="flex items-center bg-white/20 backdrop-blur-md rounded-2xl px-4 py-3 w-[90%] sm:w-[500px] shadow-lg">
        <input type="text" placeholder="Buscar tareas..."
            class="flex-1 bg-transparent text-white placeholder-white/70 focus:outline-none text-sm">
        <button class="ml-2 px-4 py-2 bg-pink-600 hover:bg-pink-700 text-white rounded-xl transition">Buscar</button>
    </div>

    <!-- Botón nueva tarea -->
    <button (click)="showModal.set(true)"
        class="mt-4 px-5 py-3 bg-pink-600 hover:bg-pink-700 text-white font-semibold rounded-xl shadow-md transition">
        + Crear nueva tarea
    </button>

    <!-- Contenedor de tarjetas -->
    <div class="bg-white/10 backdrop-blur-xl rounded-3xl mt-8 p-6 w-[90%] sm:w-[1000px] shadow-2xl">
        <div class="flex gap-1.5 justify-end ">
            <button (click)="setFilter('all')" [class.bg-purple-800]="filterStatus() === 'all'"
                class="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded-lg shadow transition">
                ALL
            </button>

            <button (click)="setFilter('pendiente')" [class.bg-purple-800]="filterStatus() === 'pendiente'"
                class="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded-lg shadow transition">
                PENDIENTE
            </button>

            <button (click)="setFilter('proceso')" [class.bg-purple-800]="filterStatus() === 'proceso'"
                class="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded-lg shadow transition">
                PROCESO
            </button>

            <button (click)="setFilter('completado')" [class.bg-purple-800]="filterStatus() === 'completado'"
                class="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded-lg shadow transition">
                COMPLETADO
            </button>
        </div>

        <h2 class="text-xl font-semibold text-white mb-4">TAREAS</h2>

        <!-- Grid de tareas -->
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
            @for(task of filteredTasks(); track task.id){
            <div class="bg-white/80 backdrop-blur-md rounded-2xl p-5 shadow-lg hover:shadow-2xl transition">
                <div class="flex justify-between items-start">
                    <h3 class="font-bold text-gray-800 text-lg">{{task.name}}</h3>
                    <span
                        class="bg-orange-400 text-white text-xs font-semibold px-2 py-1 rounded-full">{{task.status}}</span>
                </div>
                <p class="text-sm text-gray-700 mt-2">{{task.description}}</p>
                <p class="text-sm text-gray-600 mt-3 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-pink-600" fill="none"
                        viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M8 7V3m8 4V3m-9 8h10m-5 4h.01M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    Fecha límite: {{ task.fechaLimite | date:'dd/MM/yyyy' }}
                </p>

                <div class="flex justify-between mt-4">
                    <button
                        class="bg-purple-600 hover:bg-purple-700 text-white text-sm px-3 py-2 rounded-lg transition">Ver
                        Detalles
                    </button>
                    <div class="flex gap-2">
                        @if(task.status != "completado"){
                        <button (click)="taskCompleted(task.id)"
                            class="bg-green-500 hover:bg-green-600 text-white p-2 rounded-full transition"><i
                                class="fa fa-check"></i></button>
                        }

                        <button (click)="editTask(task)"
                            class="bg-yellow-500 hover:bg-yellow-600 text-white p-2 rounded-full transition">
                            <i class="fa-regular fa-pen-to-square"></i></button>
                        <button (click)="deleteTask(task.id)"
                            class="bg-red-500 hover:bg-red-600 text-white p-2 rounded-full transition"><i
                                class="fa fa-trash"></i></button>
                    </div>
                </div>
            </div>

            }

        </div>
    </div>
</div>

<!-- modales  -->
@if (showModal()) {
<div class="fixed inset-0 bg-black/50 flex justify-center items-center z-50">

    <div class="bg-white rounded-2xl w-[90%] sm:w-[400px] p-6 shadow-xl">

        <h2 class="text-xl font-bold text-gray-800 mb-4">Crear nueva tarea</h2>

        <form [formGroup]="taskForm" (ngSubmit)="saveTask()" class="flex flex-col gap-3">

            <!-- Nombre -->
            <input type="text" placeholder="Nombre de la tarea" formControlName="name"
                class="border rounded-lg p-2 w-full"
                [class.border-red-500]="taskForm.get('name')?.touched && taskForm.get('name')?.invalid" />

            <!-- Descripción -->
            <textarea placeholder="Descripción" formControlName="description"
                class="border rounded-lg p-2 w-full h-24 resize-none"
                [class.border-red-500]="taskForm.get('description')?.touched && taskForm.get('description')?.invalid"></textarea>

            <!-- Estado -->
            <select formControlName="status" class="border rounded-lg p-2 w-full"
                [class.border-red-500]="taskForm.get('status')?.touched && taskForm.get('status')?.invalid">
                <option value="" disabled>Selecciona estado</option>
                <option value="pendiente">Pendiente</option>
                <option value="proceso">En proceso</option>
                <option value="completado">Completado</option>
            </select>

            <!-- BOTONES -->
            <div class="flex justify-end gap-3 mt-5">
                <button type="button" (click)="closeModal()" class="px-4 py-2 bg-gray-300 rounded-lg">
                    Cancelar
                </button>

                <button type="submit" [disabled]="taskForm.invalid"
                    class="px-4 py-2 bg-pink-600 text-white rounded-lg disabled:opacity-50">
                    Guardar
                </button>
            </div>

        </form>

    </div>
</div>
}